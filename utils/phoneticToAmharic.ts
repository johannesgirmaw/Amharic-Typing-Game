// Standard Amharic phonetic keyboard mapping
// Based on standard Amharic keyboard layout

const phoneticMap: { [key: string]: string } = {
  // Consonant + default vowel (ə)
  he: "ሀ",
  le: "ለ",
  He: "ሐ",
  me: "መ",
  sse: "ሠ",
  re: "ረ",
  se: "ሰ",
  xe: "ሸ",
  qe: "ቀ",
  be: "በ",
  ve: "ቨ",
  te: "ተ",
  ce: "ቸ",
  hhe: "ኀ",
  ne: "ነ",
  Ne: "ኘ",
  ke: "ከ",
  Ke: "ኸ",
  we: "ወ",
  ze: "ዘ",
  Ze: "ዠ",
  ye: "የ",
  de: "ደ",
  je: "ጀ",
  ge: "ገ",
  Te: "ጠ",
  Ce: "ጨ",
  Pe: "ጰ",
  Se: "ጸ",
  SSe: "ፀ",
  fe: "ፈ",
  pe: "ፐ",

  // A vowel syllables
  ha: "ሃ",
  la: "ላ",
  Ha: "ሓ",
  ma: "ማ",
  ssa: "ሣ",
  ra: "ራ",
  sa: "ሳ",
  xa: "ሻ",
  qa: "ቃ",
  ba: "ባ",
  va: "ቫ",
  ta: "ታ",
  ca: "ቻ",
  hha: "ኃ",
  na: "ና",
  Na: "ኛ",
  ka: "ካ",
  Ka: "ኻ",
  wa: "ዋ",
  za: "ዛ",
  Za: "ዣ",
  ya: "ያ",
  da: "ዳ",
  ja: "ጃ",
  ga: "ጋ",
  Ta: "ጣ",
  Ca: "ጫ",
  Pa: "ጳ",
  Sa: "ጻ",
  SSa: "ፃ",
  fa: "ፋ",
  pa: "ፓ",

  // I and E vowel syllables (ä)
  hie: "ሄ",
  lie: "ሌ",
  Hie: "ሔ",
  mie: "ሜ",
  ssie: "ሤ",
  rie: "ሬ",
  sie: "ሴ",
  xie: "ሼ",
  qie: "ቄ",
  bie: "ቤ",
  vie: "ቬ",
  tie: "ቴ",
  cie: "ቼ",
  hhie: "ኄ",
  nie: "ኔ",
  Nie: "ኜ",
  kie: "ኬ",
  Kie: "ኼ",
  wie: "ዌ",
  zie: "ዜ",
  Zie: "ዤ",
  yie: "ዬ",
  die: "ዴ",
  jie: "ጄ",
  gie: "ጌ",
  Tie: "ጤ",
  Cie: "ጬ",
  Pie: "ጴ",
  Sie: "ጼ",
  SSie: "ፄ",
  fie: "ፌ",
  pie: "ፔ",

  // I vowel syllables
  hi: "ሂ",
  li: "ሊ",
  Hi: "ሒ",
  mi: "ሚ",
  ssi: "ሢ",
  ri: "ሪ",
  si: "ሲ",
  xi: "ሺ",
  qi: "ቂ",
  bi: "ቢ",
  vi: "ቪ",
  ti: "ቲ",
  ci: "ቺ",
  hhi: "ኂ",
  ni: "ኒ",
  Ni: "ኚ",
  ki: "ኪ",
  Ki: "ኺ",
  wi: "ዊ",
  zi: "ዢ",
  Zi: "ዢ",
  yi: "ዪ",
  di: "ዲ",
  ji: "ጂ",
  gi: "ጊ",
  Ti: "ጢ",
  Ci: "ጪ",
  Pi: "ጲ",
  Si: "ጺ",
  SSi: "ፂ",
  fi: "ፊ",
  pi: "ፒ",

  // U vowel syllables
  hu: "ሁ",
  lu: "ሉ",
  Hu: "ሑ",
  mu: "ሙ",
  ssu: "ሡ",
  ru: "ሩ",
  su: "ሱ",
  xu: "ሹ",
  qu: "ቁ",
  bu: "ቡ",
  vu: "ቩ",
  tu: "ቱ",
  cu: "ቹ",
  hhu: "ኁ",
  nu: "ኑ",
  Nu: "ኙ",
  ku: "ኩ",
  Ku: "ኹ",
  wu: "ዉ",
  zu: "ዙ",
  Zu: "ዡ",
  yu: "ዩ",
  du: "ዱ",
  ju: "ጁ",
  gu: "ጉ",
  Tu: "ጡ",
  Cu: "ጩ",
  Pu: "ጱ",
  Su: "ጹ",
  SSu: "ፁ",
  fu: "ፉ",
  pu: "ፑ",
  // Sixth letter
  h: "ህ",
  l: "ል",
  H: "ሕ",
  m: "ም",
  ss: "ሥ",
  r: "ር",
  s: "ስ",
  x: "ሽ",
  q: "ቅ",
  b: "ብ",
  v: "ቭ",
  t: "ት",
  c: "ች",
  hh: "ኅ",
  n: "ን",
  N: "ኝ",
  k: "ክ",
  K: "ኽ",
  w: "ው",
  z: "ዝ",
  Z: "ዥ",
  y: "ይ",
  d: "ድ",
  j: "ጅ",
  g: "ግ",
  T: "ጥ",
  C: "ጭ",
  P: "ጵ",
  S: "ጽ",
  SS: "ፅ",
  f: "ፍ",
  p: "ፕ",

  // O vowel syllables
  ho: "ሆ",
  lo: "ሎ",
  Ho: "ሖ",
  mo: "ሞ",
  sso: "ሦ",
  ro: "ሮ",
  so: "ሶ",
  xo: "ሾ",
  qo: "ቆ",
  bo: "ቦ",
  vo: "ቮ",
  to: "ቶ",
  co: "ቾ",
  hho: "ኆ",
  no: "ኖ",
  No: "ኞ",
  ko: "ኮ",
  Ko: "ኾ",
  wo: "ዎ",
  zo: "ዞ",
  Zo: "ዦ",
  yo: "ዮ",
  do: "ዶ",
  jo: "ጆ",
  go: "ጎ",
  To: "ጦ",
  Co: "ጮ",
  Po: "ጶ",
  So: "ጾ",
  SSo: "ፆ",
  fo: "ፎ",
  po: "ፖ",

  // Special double letters
  lua: "ሏ",
  Hua: "ሗ",
  mua: "ሟ",
  ssua: "ሧ",
  rua: "ሯ",
  sua: "ሷ",
  xua: "ሿ",
  que: "ቈ ",
  qui: "ቊ",
  quu: "ቍ",
  qua: "ቋ",
  quie: "ቌ",
  bua: "ቧ",
  vua: "ቯ",
  tua: "ቷ",
  cua: "ቿ",
  hue: "ኈ",
  hui: "ኊ",
  huu: "ኍ",
  hua: "ኋ",
  huie: "ኌ",
  nua: "ኗ",
  Nua: "ኟ",
  kue: "ኰ",
  kui: "ኲ",
  kuu: "ኵ",
  kua: "ኳ",
  kuie: "ኴ",
  zua: "ዟ",
  Zua: "ዧ",
  dua: "ዷ",
  jua: "ጇ",
  gue: "ጐ",
  gui: "ጒ",
  guu: "ጕ",
  gua: "ጓ",
  guie: "ጔ",
  Tua: "ጧ",
  Cua: "ጯ",
  Pua: "ጷ",
  Sua: "ጿ",
  fua: "ፏ",
  pua: "ፗ",

  // Single vowels (glottals)
  a: "አ",
  u: "ኡ",
  i: "ኢ",
  ea: "ኣ",
  ie: "ኤ",
  e: "እ",
  o: "ኦ",
  ae: "ኧ",

  aaa: "ዐ",
  uu: "ዑ",
  ii: "ዒ ",
  aa: "ዓ",
  iie: "ዔ",
  ee: "ዕ",
  oo: "ዖ",
};

// English to Amharic conversion
export function convertEnglishToAmharic(input: string): string {
  if (!input || input.trim() === "") return input;

  const words = input.split(/(\s+)/); // Split by spaces but keep the spaces
  const convertedWords = words.map((word) => {
    // If it's just spaces, return as is
    if (/^\s+$/.test(word)) return word;

    const lower = word.toLowerCase();

    // Try syllable-based conversion
    let result = "";
    let i = 0;

    while (i < lower.length) {
      let matched = false;

      // Try to match syllables of decreasing length (longest first)
      for (let len = Math.min(4, lower.length - i); len >= 1; len--) {
        const substr = lower.substr(i, len);
        if (phoneticMap[substr]) {
          result += phoneticMap[substr];
          i += len;
          matched = true;
          break;
        }
      }

      if (!matched) {
        // No match found, keep the character as is
        result += lower[i];
        i++;
      }
    }

    return result || word;
  });

  return convertedWords.join("");
}
